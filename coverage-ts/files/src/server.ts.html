
  <!DOCTYPE html>
  <html>
    <head>
      <title>server.ts</title>
      <link href="https://cdn.jsdelivr.net/npm/semantic-ui@2.4.2/dist/semantic.min.css" type="text/css" rel="stylesheet">
      <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.52.2/codemirror.min.js" type="text/javascript" charset="utf-8"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.52.2/mode/javascript/javascript.min.js" type="text/javascript" charset="utf-8"></script>
<link href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.52.2/codemirror.min.css" type="text/css" rel="stylesheet">
<script src="..\..\assets\source-file.js" type="text/javascript" charset="utf-8"></script>
<link href="..\..\assets\source-file.css" type="text/css" rel="stylesheet">
    </head>
    <body>
    <div style="margin-top:3em" class="ui container"><h1 class="ui header"><a href="..\..\index.html">TypeScript coverage report</a></h1><table style="margin-top:2em" class="ui celled table"><thead class=""><tr class=""><th class="">Filename</th><th class="">Percent</th><th class="">Threshold</th><th class="">Total</th><th class="">Covered</th><th class="">Uncovered</th></tr></thead><tbody class=""><tr class="positive"><td class="">src\server.ts</td><td class="">100.00%</td><td class="">80%</td><td class="">100</td><td class="">100</td><td class="">0</td></tr></tbody></table><textarea id="editor" readonly="" style="margin-top:3em">import express from &#x27;express&#x27;;
import React from &#x27;react&#x27;;
import { renderToString } from &#x27;react-dom/server&#x27;;
import App from &#x27;./client/App&#x27;;
import { Provider } from &#x27;react-redux&#x27;;
import { reducer } from &#x27;./client/store/store.js&#x27;;
import { createStore } from &#x27;redux&#x27;;
import { StaticRouter } from &quot;react-router-dom&quot;
import { State } from &#x27;./client/store/store&#x27;
import { getAverageValues, cellsCreator } from &#x27;./client/lib/lib&#x27;;

const port = 3000;
const server = express();

server.use(express.static(&#x27;dist&#x27;));

const htmlMaker = (body: string, state: State) =&gt; {
  return  `
  &lt;!DOCTYPE html&gt;
  &lt;html&gt;
    &lt;head&gt;
      &lt;title&gt;React SSR App&lt;/title&gt;
      &lt;script defer src=&quot;/bundle.js&quot;&gt;&lt;/script&gt;
      &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;/styles.css&quot;&gt;&lt;/link&gt; 
    &lt;/head&gt;
    &lt;body style=&quot;margin:0&quot;&gt;
      &lt;div id=&quot;app&quot;&gt;${body}&lt;/div&gt;
      &lt;script&gt;
          window.__PRELOADED_STATE__ = ${JSON.stringify(state).replace(
            /&lt;/g,
            &#x27;\\u003c&#x27;
          )}
      &lt;/script&gt;
    &lt;/body&gt;
  &lt;/html&gt;
  `
}

server.get(&#x27;*&#x27;, (req, res) =&gt; {
  let preloadedState: State = {
    cells: [],
    numberOfClosest: 0,
    tableFooter: []
  }
  const params = req.path.match(/(?&lt;=)\d+/gi)

  if (params &amp;&amp; params.length === 3) {
    const data = req.path.match(/(?&lt;=)\d+/gi);
    if (data) {
      const cells = cellsCreator(Number(data[1]), Number(data[0]))

      preloadedState = {
        cells,
        numberOfClosest: Number(data[2]),
        tableFooter: getAverageValues(cells)
      }
    }
  }

  const store = createStore(reducer, preloadedState);

  const context = {};

  const finalState = store.getState();

  console.log(JSON.stringify(finalState))

  let app = renderToString(
    &lt;StaticRouter location={req.path} context={context} &gt;
      &lt;Provider store={store}&gt;
        &lt;App /&gt;
      &lt;/Provider&gt;
    &lt;/StaticRouter&gt;
  )

  res.send(
    htmlMaker(app, finalState)
  )
})

server.listen(port);
console.log(`Serving at http://localhost:${port}`);
</textarea><pre id="annotations" style="display:none">[]</pre></div>
    <p class="footer-text">TypeScript Coverage Report generated by <a href="https://github.com/plantain-00/type-coverage">type-coverage</a> and <a href="https://github.com/alexcanessa/typescript-coverage-report">typescript-coverage-report</a> at Wed, 04 Nov 2020 16:03:48 GMT</p>
    </body>
  </html>
  